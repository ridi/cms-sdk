{"version":3,"sources":["../lib/Authorizer.js"],"names":["sessionHandler","req","res","next","path","isValidLogin","isValidUser","redirect","hasUrlAuth","status","send","session","get"],"mappings":";;;;;;kBAce,UAAUA,cAAV,EAA0B;AACrC,WAAO,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC7B,YAAIF,IAAIG,IAAJ,KAAa,QAAjB,EAA2B;AACvBD;AACA;AACH;;AAED,YAAI,CAACE,cAAD,IAAmB,CAACC,aAAxB,EAAuC;AACnCJ,gBAAIK,QAAJ,wBAAkCN,IAAIG,IAAtC;AACA;AACH;;AAED,YAAI,CAACI,WAAWR,cAAX,CAAL,EAAiC;AAC7BE,gBAAIO,MAAJ,GAAaC,IAAb;AACH;;AAEDP;AACH,KAhBD;AAiBH,C;;AA9BD,SAASE,YAAT,GAAwB;AACpB,WAAO,KAAP;AACH;;AAED,SAASC,WAAT,GAAuB,CAEtB;;AAED,SAASE,UAAT,CAAoBG,OAApB,EAA6B;AACzB,WAAOA,QAAQC,GAAR,CAAY,mBAAZ,KAAoCD,QAAQC,GAAR,CAAY,mBAAZ,CAA3C;AACH","file":"Authorizer.js","sourcesContent":["\n\nfunction isValidLogin() {\n    return false;\n}\n\nfunction isValidUser() {\n\n}\n\nfunction hasUrlAuth(session) {\n    return session.get('session_user_auth') && session.get('session_user_menu');\n}\n\nexport default function (sessionHandler) {\n    return function (req, res, next) {\n        if (req.path === '/login') {\n            next();\n            return;\n        }\n\n        if (!isValidLogin() || !isValidUser()) {\n            res.redirect(`/login?return_url=${req.path}`);\n            return;\n        }\n\n        if (!hasUrlAuth(sessionHandler)) {\n            res.status().send();\n        }\n\n        next();\n    }\n}"]}